


<style>

  body{ background: linear-gradient(135deg, rgb(0, 0, 0) 0%, rgb(79, 71, 71)
  43%, rgb(170, 198, 178) 100%); background-attachment: fixed; font-family:
  'Arima Madurai', cursive; }
  #myBtn {
  display: none;
  position: fixed;
  bottom: 20px;
  right: 30px;
  z-index: 99;
  font-size: 18px;
  border: none;
  outline: none;
  background-color: rgb(50, 45, 45);
  color: white;
  cursor: pointer;
  padding: 15px;
  border-radius: 4px;
}

#myBtn:hover {
  background-color: #555;
}

</style> 
<div class="row col-12">

  <div
    class="col-lg-2 col-12 col-sm-3 ml-3 m-sm-0 m-xl-3 col-md-4 container-fluid bg-gradient m-1"
    style="border-radius:15px ; "
  >

    <span
      class="dot mt-3"
      style=" background-image:url(https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQXAS-s6-wcK3enD1Z6kuBGONuyTKR6M5a3KeAI9w_ACQ&s) ; background-position:-35px -24px ;  height: 60px;
          width: 60px;
          background-color: #bbb;
          border-radius: 50%;
          display: inline-block;"
    ></span>
    <div
      class="bg-danger bg-gradient col-9 py-1 mt-5 text-center"
      style="border-radius:167px ; "
    >
      <h6><i class="fa-solid fa-user-gear"></i> Supertramp </h6>
    </div>

    <div
      class="bg-danger bg-gradient col-12 py-2 mt-5"
      style="border-radius:14px ; "
    >
      <h6>Profile</h6>
    </div>
    <div
      class="bg-danger bg-gradient col-12 py-2 mt-5"
      style="border-radius:14px  ;"
    >
      <h6>PRO management</h6>
    </div>
    <div
      class="bg-danger bg-gradient col-12 py-2 mt-5 mb-3"
      style="border-radius:14px  ;"
    >
      <h6>Help desk</h6>
    </div>

  </div>

  <div
    class="container mt-5 col-lg-8 col-md-6 co-sm-4"
    style="font-size:15px ;"
  >

<div class="col-lg-8 text-white " >
  <h4 class="m-lg-6 mt-3 " style=" font-family: 'Arima Madurai', cursive; font-weight: 700;" >ADD NEW COUPEN</h4>
  <form action="/admin/addcoupen" method="POST">
  <div class="form-group">
    <label>Coupen</label>
    <input type="text" required class="form-control" id="myInput" name="coupen" onkeyup="comparenames()" onblur="cempty()"  placeholder="Enter new coupen">
    <h6 id="exist" class="m-2 text-danger font-weight-bold"></h6>
   
  </div>
  <div class="form-group">
    <label>Description</label>
    <input type="text" required class="form-control py-5" name="description"  placeholder="Description">
   
  </div>  <div class="form-group">
    <label>Offer Percentage</label>
    <input type="number" required class="form-control" name="offer" id="offerpercentage" oninput="validateoffer()" placeholder="Min: offer Percentage">
   <h6 id="offererr" class="m-2 text-danger font-weight-bold"></h6>
  </div>
   <div class="form-group">
    <label>Min Purchase Amount</label>
    <input type="number" required class="form-control" name="Min_Amount"  placeholder="Min: purchase ">
   
  </div>
  <button type="submit" class="btn btn-primary" id="addnew" >Add New Coupen</button>


</form>
 






</div>
</div>
   

<div class="container   col-12 col-lg-8" >
 <h1 class="bg-gradient mt-4 text-white ">Coupen Table</h1>
    <table id="myTable" class="table table-striped table-responsive table-dark">
      <thead>
        <tr>
          <th class="" scope="col-4">NO:</th>
          <th scope="col-4">Coupen Name</th>
          <th class="d-none d-lg-block" scope="col-4">Description</th>
          <th class="col-1">offer percentage</th>
 <th class="col-1">min Purchase Amount</th>
     <th class="col-4">Options</th>
        </tr>
      </thead>
      <tbody>
      {{#each coupens}}
          <tr>
            <th scope="row"><span
                class="create_index"
              ></span></th>
            <td>{{this.coupen}}</td>
            <td class="text-truncate d-none d-lg-block">{{this.description}}</td>
              <td>{{this.offer}}</td>
            <td>{{this.Min_Amount}}</td>
            <td><a href="/admin/editcoupendetails/{{this._id}}" class="btn btn-primary m-1"  ><i class="fa-sharp fa-solid fa-pen"></i></a><button class="m-1 btn btn-danger" onclick="confirmdelete('{{this._id}}')" ><i class="fa-solid fa-trash"></i></button></td>
                 
</tr>
{{/each}}

      </tbody>
    </table>

</div>
    <script>
      var divs = document.querySelectorAll('.create_index'); for (var i = 0; i <
      divs.length; ++i) { divs[i].innerHTML = i + 1; }
    </script>

  </div>

</div>
<button onclick="topFunction()"  id="myBtn" title="Go to top"><i class="fa-solid fa-angles-up"></i></button>
<div class="bg-gradient text-center text-white "  style="background-color:RGB(60, 100, 51) ;">
<p class="mt-2 mb-2" style="opacity: 20%;">2020 Â© copyright @Plantography</p>
</div>
<script>
// Get the button
let mybutton = document.getElementById("myBtn");

// When the user scrolls down 20px from the top of the document, show the button
window.onscroll = function() {scrollFunction()};

function scrollFunction() {
  if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
    mybutton.style.display = "block";
  } else {
    mybutton.style.display = "none";
  }
}

// When the user clicks on the button, scroll to the top of the document
function topFunction() {
  document.body.scrollTop = 0;
  document.documentElement.scrollTop = 0;
}
</script>


<script>
 
{{!-- function onkeydownfunction --}}



 function comparenames() {
  var input, filter, table, tr, td, i, txtValue;
  input = document.getElementById("myInput");
  
    
  filter = input.value.toUpperCase();
  
  table = document.getElementById("myTable");
  tr = table.getElementsByTagName("tr");
  for (i = 0; i < tr.length; i++) {
    td = tr[i].getElementsByTagName("td")[0];
    if (td) {
      txtValue = td.textContent || td.innerText;
      if (txtValue.toUpperCase().indexOf(filter) > -1) {
               
         
       document.getElementById('exist').innerHTML="Coupen name Already exist......!"
        document.getElementById('addnew').disabled=true
       p.innerHTML=text
      } else {
        
     document.getElementById('exist').innerHTML=""
     document.getElementById('addnew').disabled=false
      
       
      
      }
    }       
  }
}



</script>


<script>
  function cempty(){
       let input = document.getElementById("myInput");
       if(input.value.length==0){
        document.getElementById("exist").innerHTML="Name field cannot be Empty....!"
       }

  }
</script>


<script>

  function deletecoupen(coupenid){
    $.ajax({
       url:"/admin/deletecoupen",
       method:"post",
       data:{
        coupenid:coupenid
       } ,
       success:(Response)=>{
       
        location.reload()
       } 



    })
  }


  function confirmdelete(coupenid){
    swal({
  title: "Are you sure?",
  text: "Once deleted, you will not be able to recover this  coupen!",
  icon: "warning",
  buttons: true,
  dangerMode: true,
})
.then((willDelete) => {
  if (willDelete) {
    deletecoupen(coupenid)
    swal("Poof! Your file has been deleted!", {
      icon: "success",
    });
  } else {
    swal("Your coupen file is safe!");
  }
});
  }

function validateoffer(){
  let offer=document.getElementById('offerpercentage').value
 console.log(offer)
  if(offer>90){
    console.log(offer)
    document.getElementById('addnew').disabled=true
    document.getElementById('offererr').innerHTML="Offer percentege must be lower than 90%...!"
     
  }else{
    document.getElementById('addnew').disabled=false
    document.getElementById('offererr').innerHTML=""
  }
}


</script>